<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>FancyPipe &mdash; FancyPipe 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/site.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="FancyPipe 1.0 documentation" href="#" />
    <link rel="next" title="Installation" href="installation.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             accesskey="N">next</a> |</li>
        <li><a href="#">FancyPipe 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="#">
              <img class="logo" src="_static/fancypipelogo.jpg" alt="Logo"/>
            </a></p>
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">FancyPipe</a><ul>
<li><a class="reference internal" href="#programming-serial-vs-parallel">Programming: serial vs. parallel</a></li>
<li><a class="reference internal" href="#html-logging">HTML logging</a></li>
<li><a class="reference internal" href="#parameter-management">Parameter management</a></li>
<li><a class="reference internal" href="#command-line-interface">Command line interface</a></li>
<li><a class="reference internal" href="#temporary-files-and-garbage-collection">Temporary files and garbage collection</a></li>
<li><a class="reference internal" href="#error-handling">Error handling</a></li>
<li><a class="reference internal" href="#documentation-tree">Documentation tree</a></li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>

  <h4>Next topic</h4>
  <p class="topless"><a href="installation.html"
                        title="next chapter">Installation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="fancypipe">
<h1>FancyPipe<a class="headerlink" href="#fancypipe" title="Permalink to this headline">¶</a></h1>
<p>FancyPipe is an open <a class="reference external" href="https://github.com/rbakker/FancyPipe">source</a>
python package for running cpu-intensive data processing pipelines.
It covers those aspects that would otherwise distract you from your
main job: the design of the processing steps.</p>
<p>FancyPipe takes care of:</p>
<ul class="simple">
<li>parallel and distributed execution of code</li>
<li>html-based, hierarchical logging</li>
<li>pipeline parameter management</li>
<li>command line interface</li>
<li>temporary files and garbage collection</li>
<li>error handling</li>
</ul>
<div class="section" id="programming-serial-vs-parallel">
<h2>Programming: serial vs. parallel<a class="headerlink" href="#programming-serial-vs-parallel" title="Permalink to this headline">¶</a></h2>
<p>In FancyPipe, you build your pipeline as a (nested) set of FancyTasks.
When you run() a FancyTask, three methods are called successively:
init(...), main(...), and done(...), thereby using the result of each
method as input to the next. By default, all three just copy input to
output, so to have the Task do something useful, you need to overwrite
at least one of these methods. Only main() should contain cpu-intensive
code, because it is run in parallel mode whenever possible.
If the task is not cpu-intensive at all, then you can save parallel
processing overhead by leaving main() undefined and putting all code in
init().</p>
<p>Once the Task is implemented, there are two ways to run it.
The simplest way is to use this chain of commands:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">myTask</span><span class="o">.</span><span class="n">setInput</span><span class="p">(</span> <span class="o">...</span> <span class="p">)</span>
<span class="n">myTask</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">myTask</span><span class="o">.</span><span class="n">getOutput</span><span class="p">(</span> <span class="n">key</span> <span class="p">)</span>
</pre></div>
</div>
<p>With myTask.setInput() you set the variables that will be passed to
myTask.init(). myTask.run() stores the output of myTask.done()
inside the myTask object. myTask.getOutput( key ) retrieves the key-th
element of this stored output.</p>
<p>The above code does not allow parallel execution. For that you need to use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">task1a</span><span class="o">.</span><span class="n">setInput</span><span class="p">(</span> <span class="o">...</span> <span class="p">)</span>
<span class="n">task1b</span><span class="o">.</span><span class="n">setInput</span><span class="p">(</span> <span class="o">...</span> <span class="p">)</span>
<span class="n">task2</span><span class="o">.</span><span class="n">setInput</span><span class="p">(</span>
  <span class="n">task1a</span><span class="o">.</span><span class="n">requestOutput</span><span class="p">(</span><span class="n">key</span><span class="p">),</span>
  <span class="n">task1b</span><span class="o">.</span><span class="n">requestOutput</span><span class="p">(</span><span class="n">key</span><span class="p">),</span>
  <span class="o">...</span>
<span class="p">)</span>
<span class="n">task2</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>When task2 is run, FancyPipe will automatically detect that its inputs
contain output-requests to task1a and task1b, and it will run these
tasks first, in parallel. This illustrates the basic idea of parallel
programming in FancyPipe.
The <a class="reference external" href="parallelprogramming.html">parallel programming page</a> describes
more complex cases.</p>
<p>When you call a FancyPipe program from the command line, you can specify
the resources that are available for parallel processing. Three
<a class="reference external" href="parallelprocessing.html">parallel execution modes</a> are supported:
multi-threading, multi-processing, and distributed processing (experimental).</p>
</div>
<div class="section" id="html-logging">
<h2>HTML logging<a class="headerlink" href="#html-logging" title="Permalink to this headline">¶</a></h2>
<p>Whenever a task is run, a json-encoded entry is added to a log file,
shared by all parallel processing nodes. There is no need to
explicitly add entries to the log file. When the task finishes, its
console output is attached to the log entry.
The page &#8216;fancylog.html&#8217; contains scripts to disentangle this log file,
and to present the results in a hierarchical tree, which can already
be viewed while the job is running.</p>
</div>
<div class="section" id="parameter-management">
<h2>Parameter management<a class="headerlink" href="#parameter-management" title="Permalink to this headline">¶</a></h2>
<p>Data processing pipelines deal with two sets of parameters:</p>
<ol class="arabic simple">
<li>Parameters that control the environment in which the pipeline runs.</li>
<li>Parameters used by the pipeline tasks.</li>
</ol>
<p>In FancyPipe, the environment parameters need to be passed only to the
outer task, typically from the command line. They are propagated
automatically to all child tasks.</p>
<p>Task parameters can be provided at three levels.</p>
<ol class="arabic simple">
<li>Default values are specified in the task code.</li>
<li>A configuration file may override these defaults, by specifying context-value pairs. The context specifies under which conditions the parameter should be used.</li>
<li>The parent task may override the configuration file values.</li>
</ol>
</div>
<div class="section" id="command-line-interface">
<h2>Command line interface<a class="headerlink" href="#command-line-interface" title="Permalink to this headline">¶</a></h2>
<p>Each task for which input types are defined can be run from the
command line, by the name of the source file. If the source file
contains multiple tasks, then the generic command &#8216;runtask.py&#8217; can
be used to specify the sourcefile and task name.</p>
</div>
<div class="section" id="temporary-files-and-garbage-collection">
<h2>Temporary files and garbage collection<a class="headerlink" href="#temporary-files-and-garbage-collection" title="Permalink to this headline">¶</a></h2>
<p>The outer task uses an input parameter &#8216;tempdir&#8217; to manage storage of
intermediate results. Child tasks create subdirectories in the parent
folder if they need to save temporary files. Directory names start with
a digit, which represents the order at which the child was created.</p>
<p>Garbage collection is the removal of intermediate results when they are
no longer needed. When a task has completed, all temporary files created
by task.tempdir() and task.tempfile() are removed, unless these files
are returned as output of the task. In that case, the parent task inherits
the files and either removes them later, or returns them as output.
In the end of this recursive scheme, all temporary files except for
those returned by the outer task are removed.</p>
<p>The command line option &#8216;-nocleanup&#8217; disables garbage collection.</p>
</div>
<div class="section" id="error-handling">
<h2>Error handling<a class="headerlink" href="#error-handling" title="Permalink to this headline">¶</a></h2>
<p>When an error occurs in any of the processing nodes, execution halts and
control is returned to the main process, triggering a second error that
terminates all active processing nodes. Both error messages and a full
traceback report are prominently displayed both in the console and in
the html log file.</p>
</div>
<div class="section" id="documentation-tree">
<h2>Documentation tree<a class="headerlink" href="#documentation-tree" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallelprogramming.html">Creating a FancyPipe program</a><ul>
<li class="toctree-l2"><a class="reference internal" href="parallelprogramming.html#a-single-task">A single task</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallelprogramming.html#running-the-task">Running the task</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallelprogramming.html#two-tasks-serial-programming">Two tasks, serial programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallelprogramming.html#two-tasks-parallel-programming">Two tasks, parallel programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallelprogramming.html#calling-external-programs">Calling external programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallelprogramming.html#parallel-processing-paradigms">Parallel processing paradigms</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parallelprocessing.html">Parallel processing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="parallelprocessing.html#multi-threading-multi-processing-and-distributed-processing">Multi-threading, multi-processing, and distributed processing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="classesmethods.html">Classes and methods</a></li>
</ul>
</div>
</div>
<div class="section" id="indices-and-tables">
<h2>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><em>Index</em></a></li>
<li><a class="reference internal" href="py-modindex.html"><em>Module Index</em></a></li>
<li><a class="reference internal" href="search.html"><em>Search Page</em></a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             >next</a> |</li>
        <li><a href="#">FancyPipe 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Rembrandt Bakker.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>